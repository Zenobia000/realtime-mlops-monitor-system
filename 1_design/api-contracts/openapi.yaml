openapi: 3.0.3
info:
  title: Model API ç›£æ§ç³»çµ±
  description: |
    Model API å³æ™‚ç›£æ§ç³»çµ±æä¾›å®Œæ•´çš„ API ç›£æ§ã€æŒ‡æ¨™æŸ¥è©¢ã€å‘Šè­¦ç®¡ç†å’Œå¯¦æ™‚æ•¸æ“šæ¨é€åŠŸèƒ½ã€‚
    
    ## ä¸»è¦åŠŸèƒ½
    - ğŸ¥ **ç³»çµ±å¥åº·ç›£æ§** - æœå‹™ç‹€æ…‹æª¢æŸ¥å’Œä¾è³´ç›£æ§
    - ğŸ“Š **æŒ‡æ¨™æŸ¥è©¢** - å¯¦æ™‚å’Œæ­·å²æŒ‡æ¨™æ•¸æ“šæŸ¥è©¢
    - ğŸš¨ **å‘Šè­¦ç®¡ç†** - æ™ºèƒ½å‘Šè­¦è¦å‰‡å’Œé€šçŸ¥
    - ğŸ“ˆ **å„€è¡¨æ¿æ•¸æ“š** - å¯è¦–åŒ–æ•¸æ“šæ”¯æŒ
    - âš¡ **å¯¦æ™‚æ¨é€** - WebSocket å¯¦æ™‚æ•¸æ“šæµ
    
    ## èªè­‰æ–¹å¼
    
    æ”¯æŒå…©ç¨® API Key èªè­‰æ–¹å¼ï¼š
    
    1. **Header èªè­‰** (æ¨è–¦)
       ```
       X-API-Key: your-api-key
       ```
    
    2. **Bearer Token èªè­‰**
       ```
       Authorization: Bearer your-api-key
       ```
       
    ## é™åˆ¶
    - API é™åˆ¶: 300 requests/minute
    - WebSocket é€£æ¥: 5 concurrent connections
    - æ•¸æ“šä¿ç•™: 30 å¤©
  version: "1.0.0"
  contact:
    name: API æ”¯æ´
    email: support@monitor.example.com
    url: https://docs.monitor.example.com
  license:
    name: MIT
    url: https://opensource.org/licenses/MIT
  termsOfService: https://monitor.example.com/terms

servers:
  - url: http://localhost:8001
    description: é–‹ç™¼ç’°å¢ƒ
  - url: https://test-api.monitor.example.com
    description: æ¸¬è©¦ç’°å¢ƒ
  - url: https://api.monitor.example.com
    description: ç”Ÿç”¢ç’°å¢ƒ

security:
  - ApiKeyAuth: []
  - BearerAuth: []

paths:
  /:
    get:
      summary: æœå‹™æ ¹ç›®éŒ„
      description: ç²å–æœå‹™åŸºæœ¬ä¿¡æ¯
      operationId: getRoot
      tags: ["ç³»çµ±"]
      security: []
      responses:
        "200":
          description: æœå‹™åŸºæœ¬ä¿¡æ¯
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ServiceInfo"

  /health:
    get:
      summary: å¥åº·æª¢æŸ¥
      description: æª¢æŸ¥ç³»çµ±å¥åº·ç‹€æ…‹å’Œä¾è³´æœå‹™
      operationId: getHealth
      tags: ["ç³»çµ±"]
      security: []
      responses:
        "200":
          description: ç³»çµ±å¥åº·
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/HealthResponse"
        "503":
          description: ç³»çµ±ä¸å¥åº·
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /v1:
    get:
      summary: API ç‰ˆæœ¬ä¿¡æ¯
      description: ç²å– API v1 ç‰ˆæœ¬ä¿¡æ¯å’Œå¯ç”¨ç«¯é»
      operationId: getApiInfo
      tags: ["ç³»çµ±"]
      security: []
      responses:
        "200":
          description: API ç‰ˆæœ¬ä¿¡æ¯
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ApiInfo"

  /v1/metrics/summary:
    get:
      summary: æŒ‡æ¨™æ‘˜è¦
      description: ç²å–ç³»çµ±æ•´é«”æŒ‡æ¨™æ‘˜è¦
      operationId: getMetricsSummary
      tags: ["æŒ‡æ¨™æŸ¥è©¢"]
      parameters:
        - name: start_time
          in: query
          description: é–‹å§‹æ™‚é–“ (ISO 8601)
          schema:
            type: string
            format: date-time
        - name: end_time
          in: query
          description: çµæŸæ™‚é–“ (ISO 8601)
          schema:
            type: string
            format: date-time
        - name: service_name
          in: query
          description: ç¯©é¸ç‰¹å®šæœå‹™
          schema:
            type: string
      responses:
        "200":
          description: æŒ‡æ¨™æ‘˜è¦æ•¸æ“š
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MetricsSummaryResponse"
        "401":
          $ref: "#/components/responses/UnauthorizedError"
        "429":
          $ref: "#/components/responses/RateLimitError"

  /v1/metrics/historical:
    get:
      summary: æ­·å²æŒ‡æ¨™
      description: æŸ¥è©¢æ­·å²æŒ‡æ¨™æ•¸æ“š
      operationId: getHistoricalMetrics
      tags: ["æŒ‡æ¨™æŸ¥è©¢"]
      parameters:
        - name: start_time
          in: query
          description: é–‹å§‹æ™‚é–“ (ISO 8601)
          schema:
            type: string
            format: date-time
        - name: end_time
          in: query
          description: çµæŸæ™‚é–“ (ISO 8601)
          schema:
            type: string
            format: date-time
        - name: service_name
          in: query
          description: æœå‹™åç¨±
          schema:
            type: string
        - name: endpoint
          in: query
          description: ç«¯é»è·¯å¾‘
          schema:
            type: string
        - name: metric_type
          in: query
          description: æŒ‡æ¨™é¡å‹
          schema:
            type: string
            enum: [overall, service, endpoint]
            default: overall
        - name: limit
          in: query
          description: è¿”å›æ•¸é‡é™åˆ¶
          schema:
            type: integer
            minimum: 1
            maximum: 1000
            default: 100
        - name: offset
          in: query
          description: åç§»é‡
          schema:
            type: integer
            minimum: 0
            default: 0
      responses:
        "200":
          description: æ­·å²æŒ‡æ¨™æ•¸æ“š
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/HistoricalMetricsResponse"
        "401":
          $ref: "#/components/responses/UnauthorizedError"

  /v1/metrics/real-time:
    get:
      summary: å¯¦æ™‚æŒ‡æ¨™
      description: ç²å–å¯¦æ™‚æŒ‡æ¨™æ•¸æ“š (Redis å¿«å–)
      operationId: getRealTimeMetrics
      tags: ["æŒ‡æ¨™æŸ¥è©¢"]
      parameters:
        - name: service_name
          in: query
          description: ç¯©é¸ç‰¹å®šæœå‹™
          schema:
            type: string
      responses:
        "200":
          description: å¯¦æ™‚æŒ‡æ¨™æ•¸æ“š
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RealTimeMetricsResponse"
        "401":
          $ref: "#/components/responses/UnauthorizedError"

  /v1/metrics/services:
    get:
      summary: ç›£æ§æœå‹™åˆ—è¡¨
      description: ç²å–æ‰€æœ‰è¢«ç›£æ§çš„æœå‹™åˆ—è¡¨åŠå…¶çµ±è¨ˆ
      operationId: getMonitoredServices
      tags: ["æŒ‡æ¨™æŸ¥è©¢"]
      responses:
        "200":
          description: ç›£æ§æœå‹™åˆ—è¡¨
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/MonitoredServicesResponse"
        "401":
          $ref: "#/components/responses/UnauthorizedError"

  /v1/metrics/services/{service_name}/endpoints:
    get:
      summary: æœå‹™ç«¯é»è©³æƒ…
      description: ç²å–ç‰¹å®šæœå‹™çš„ç«¯é»è©³ç´°ä¿¡æ¯
      operationId: getServiceEndpoints
      tags: ["æŒ‡æ¨™æŸ¥è©¢"]
      parameters:
        - name: service_name
          in: path
          required: true
          description: æœå‹™åç¨±
          schema:
            type: string
      responses:
        "200":
          description: æœå‹™ç«¯é»è©³æƒ…
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ServiceEndpointsResponse"
        "404":
          $ref: "#/components/responses/NotFoundError"
        "401":
          $ref: "#/components/responses/UnauthorizedError"

  /v1/alerts/:
    get:
      summary: å‘Šè­¦åˆ—è¡¨
      description: ç²å–å‘Šè­¦åˆ—è¡¨
      operationId: getAlerts
      tags: ["å‘Šè­¦ç®¡ç†"]
      parameters:
        - name: status
          in: query
          description: å‘Šè­¦ç‹€æ…‹
          schema:
            type: string
            enum: [triggered, resolved, acknowledged]
        - name: severity
          in: query
          description: åš´é‡ç¨‹åº¦
          schema:
            type: string
            enum: [low, medium, high, critical]
        - name: service_name
          in: query
          description: æœå‹™åç¨±
          schema:
            type: string
        - name: limit
          in: query
          description: è¿”å›æ•¸é‡
          schema:
            type: integer
            minimum: 1
            maximum: 1000
            default: 50
        - name: offset
          in: query
          description: åç§»é‡
          schema:
            type: integer
            minimum: 0
            default: 0
      responses:
        "200":
          description: å‘Šè­¦åˆ—è¡¨
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AlertsResponse"
        "401":
          $ref: "#/components/responses/UnauthorizedError"

  /v1/alerts/active:
    get:
      summary: æ´»èºå‘Šè­¦
      description: ç²å–ç•¶å‰æ´»èºå‘Šè­¦
      operationId: getActiveAlerts
      tags: ["å‘Šè­¦ç®¡ç†"]
      responses:
        "200":
          description: æ´»èºå‘Šè­¦åˆ—è¡¨
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ActiveAlertsResponse"
        "401":
          $ref: "#/components/responses/UnauthorizedError"

  /v1/services/:
    get:
      summary: æœå‹™æ¦‚è¦½
      description: ç²å–æ‰€æœ‰æœå‹™çš„å¥åº·ç‹€æ…‹å’Œæ€§èƒ½æ¦‚è¦½
      operationId: getServicesOverview
      tags: ["æœå‹™ç›£æ§"]
      responses:
        "200":
          description: æœå‹™æ¦‚è¦½
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ServicesOverviewResponse"
        "401":
          $ref: "#/components/responses/UnauthorizedError"

  /v1/dashboards/overview:
    get:
      summary: å„€è¡¨æ¿æ¦‚è¦½
      description: ç²å–å„€è¡¨æ¿ç¸½è¦½æ•¸æ“š
      operationId: getDashboardOverview
      tags: ["å„€è¡¨æ¿"]
      parameters:
        - name: time_range
          in: query
          description: æ™‚é–“ç¯„åœ
          schema:
            type: string
            enum: [1h, 6h, 24h, 7d, 30d]
            default: 1h
      responses:
        "200":
          description: å„€è¡¨æ¿æ¦‚è¦½æ•¸æ“š
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/DashboardOverviewResponse"
        "401":
          $ref: "#/components/responses/UnauthorizedError"

  /v1/dashboards/metrics/timeseries:
    get:
      summary: æ™‚é–“åºåˆ—æ•¸æ“š
      description: ç²å–æŒ‡æ¨™çš„æ™‚é–“åºåˆ—æ•¸æ“š
      operationId: getTimeSeriesData
      tags: ["å„€è¡¨æ¿"]
      parameters:
        - name: metric
          in: query
          required: true
          description: æŒ‡æ¨™é¡å‹
          schema:
            type: string
            enum: [qps, error_rate, avg_response_time, p95_response_time, p99_response_time]
        - name: service_name
          in: query
          description: æœå‹™åç¨±
          schema:
            type: string
        - name: hours
          in: query
          description: æ™‚é–“ç¯„åœ(å°æ™‚)
          schema:
            type: integer
            minimum: 1
            maximum: 168
            default: 24
        - name: interval
          in: query
          description: é–“éš”(åˆ†é˜)
          schema:
            type: integer
            enum: [1, 5, 15, 30, 60]
            default: 60
      responses:
        "200":
          description: æ™‚é–“åºåˆ—æ•¸æ“š
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/TimeSeriesResponse"
        "400":
          $ref: "#/components/responses/BadRequestError"
        "401":
          $ref: "#/components/responses/UnauthorizedError"

  /v1/dashboards/realtime:
    get:
      summary: å¯¦æ™‚å„€è¡¨æ¿
      description: ç²å–å¯¦æ™‚å„€è¡¨æ¿æ•¸æ“š
      operationId: getRealtimeDashboard
      tags: ["å„€è¡¨æ¿"]
      responses:
        "200":
          description: å¯¦æ™‚å„€è¡¨æ¿æ•¸æ“š
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/RealtimeDashboardResponse"
        "401":
          $ref: "#/components/responses/UnauthorizedError"

components:
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: X-API-Key
      description: API Key èªè­‰
    BearerAuth:
      type: http
      scheme: bearer
      description: Bearer Token èªè­‰

  schemas:
    ServiceInfo:
      type: object
      required: [message, version, docs]
      properties:
        message:
          type: string
          example: "Model API ç›£æ§ç³»çµ±"
        version:
          type: string
          example: "1.0.0"
        docs:
          type: string
          example: "/docs"

    HealthResponse:
      type: object
      required: [success, data, timestamp]
      properties:
        success:
          type: boolean
          example: true
        data:
          $ref: "#/components/schemas/HealthData"
        timestamp:
          type: string
          format: date-time

    HealthData:
      type: object
      required: [status, version, uptime_seconds, dependencies, environment]
      properties:
        status:
          type: string
          enum: [healthy, unhealthy, degraded]
        version:
          type: string
          example: "1.0.0"
        uptime_seconds:
          type: integer
          example: 86400
        dependencies:
          $ref: "#/components/schemas/Dependencies"
        environment:
          type: string
          enum: [development, staging, production]

    Dependencies:
      type: object
      properties:
        postgresql:
          type: string
          enum: [healthy, unhealthy, unknown]
        redis:
          type: string
          enum: [healthy, unhealthy, unknown]
        rabbitmq:
          type: string
          enum: [healthy, unhealthy, unknown]

    ApiInfo:
      type: object
      required: [version, endpoints, available_routes, websocket_endpoints]
      properties:
        version:
          type: string
          example: "v1"
        endpoints:
          type: object
          additionalProperties:
            type: string
        available_routes:
          type: array
          items:
            type: string
        websocket_endpoints:
          type: array
          items:
            type: string

    MetricsSummaryResponse:
      type: object
      required: [success, data, timestamp]
      properties:
        success:
          type: boolean
          example: true
        data:
          $ref: "#/components/schemas/MetricsSummaryData"
        timestamp:
          type: string
          format: date-time

    MetricsSummaryData:
      type: object
      required: [summary, services, time_range]
      properties:
        summary:
          $ref: "#/components/schemas/MetricsSummary"
        services:
          type: array
          items:
            $ref: "#/components/schemas/ServiceMetrics"
        time_range:
          $ref: "#/components/schemas/TimeRange"

    MetricsSummary:
      type: object
      required: [total_services, total_endpoints, total_requests, average_qps, average_error_rate, average_response_time]
      properties:
        total_services:
          type: integer
          example: 5
        total_endpoints:
          type: integer
          example: 20
        total_requests:
          type: integer
          example: 15000
        average_qps:
          type: number
          format: float
          example: 4.2
        average_error_rate:
          type: number
          format: float
          example: 0.5
        average_response_time:
          type: number
          format: float
          example: 145.2

    ServiceMetrics:
      type: object
      required: [service_name, qps, error_rate, avg_response_time, status]
      properties:
        service_name:
          type: string
          example: "model-api-v1"
        qps:
          type: number
          format: float
          example: 2.5
        error_rate:
          type: number
          format: float
          example: 0.2
        avg_response_time:
          type: number
          format: float
          example: 120.5
        p95_response_time:
          type: number
          format: float
          example: 180.2
        p99_response_time:
          type: number
          format: float
          example: 250.8
        total_requests:
          type: integer
          example: 1500
        total_errors:
          type: integer
          example: 3
        status:
          type: string
          enum: [healthy, degraded, unhealthy, unknown]

    TimeRange:
      type: object
      required: [start_time, end_time, duration_seconds]
      properties:
        start_time:
          type: string
          format: date-time
        end_time:
          type: string
          format: date-time
        duration_seconds:
          type: integer
          example: 3600

    HistoricalMetricsResponse:
      type: object
      required: [success, data, timestamp]
      properties:
        success:
          type: boolean
          example: true
        data:
          $ref: "#/components/schemas/HistoricalMetricsData"
        timestamp:
          type: string
          format: date-time

    HistoricalMetricsData:
      type: object
      required: [metrics, pagination, filters]
      properties:
        metrics:
          type: array
          items:
            $ref: "#/components/schemas/HistoricalMetric"
        pagination:
          $ref: "#/components/schemas/Pagination"
        filters:
          $ref: "#/components/schemas/MetricsFilters"

    HistoricalMetric:
      type: object
      required: [timestamp, qps, error_rate, avg_response_time, p95_response_time, p99_response_time, total_requests, total_errors]
      properties:
        timestamp:
          type: string
          format: date-time
        service_name:
          type: string
          nullable: true
        endpoint:
          type: string
          nullable: true
        qps:
          type: number
          format: float
        error_rate:
          type: number
          format: float
        avg_response_time:
          type: number
          format: float
        p95_response_time:
          type: number
          format: float
        p99_response_time:
          type: number
          format: float
        total_requests:
          type: integer
        total_errors:
          type: integer

    Pagination:
      type: object
      required: [total, limit, offset, has_more]
      properties:
        total:
          type: integer
          example: 1500
        limit:
          type: integer
          example: 100
        offset:
          type: integer
          example: 0
        has_more:
          type: boolean
          example: true

    MetricsFilters:
      type: object
      properties:
        service_name:
          type: string
          nullable: true
        endpoint:
          type: string
          nullable: true
        start_time:
          type: string
          format: date-time
        end_time:
          type: string
          format: date-time

    RealTimeMetricsResponse:
      type: object
      required: [success, data, timestamp]
      properties:
        success:
          type: boolean
          example: true
        data:
          $ref: "#/components/schemas/RealTimeMetricsData"
        timestamp:
          type: string
          format: date-time

    RealTimeMetricsData:
      type: object
      required: [real_time_metrics, service_summary, total_services, total_metrics, cache_ttl_seconds]
      properties:
        real_time_metrics:
          type: array
          items:
            $ref: "#/components/schemas/RealTimeMetric"
        service_summary:
          type: array
          items:
            $ref: "#/components/schemas/ServiceSummary"
        total_services:
          type: integer
        total_metrics:
          type: integer
        cache_ttl_seconds:
          type: integer
          example: 300

    RealTimeMetric:
      type: object
      required: [service_name, qps, error_rate, avg_response_time, p95_response_time, p99_response_time, last_updated]
      properties:
        service_name:
          type: string
        qps:
          type: number
          format: float
        error_rate:
          type: number
          format: float
        avg_response_time:
          type: number
          format: float
        p95_response_time:
          type: number
          format: float
        p99_response_time:
          type: number
          format: float
        last_updated:
          type: string
          format: date-time

    ServiceSummary:
      type: object
      required: [service_name, status, qps, error_rate]
      properties:
        service_name:
          type: string
        status:
          type: string
          enum: [healthy, degraded, unhealthy, unknown]
        qps:
          type: number
          format: float
        error_rate:
          type: number
          format: float

    ErrorResponse:
      type: object
      required: [success, error, timestamp]
      properties:
        success:
          type: boolean
          example: false
        error:
          $ref: "#/components/schemas/ErrorDetail"
        timestamp:
          type: string
          format: date-time

    ErrorDetail:
      type: object
      required: [code, message]
      properties:
        code:
          type: string
          example: "INVALID_API_KEY"
        message:
          type: string
          example: "ç„¡æ•ˆçš„ API Key"
        developer_message:
          type: string
          example: "è«‹æª¢æŸ¥æ‚¨çš„ API Key æ˜¯å¦æ­£ç¢º"

    MonitoredServicesResponse:
      type: object
      required: [success, data, timestamp]
      properties:
        success:
          type: boolean
          example: true
        data:
          $ref: "#/components/schemas/MonitoredServicesData"
        timestamp:
          type: string
          format: date-time

    MonitoredServicesData:
      type: object
      required: [services, total_count]
      properties:
        services:
          type: array
          items:
            $ref: "#/components/schemas/MonitoredService"
        total_count:
          type: integer

    MonitoredService:
      type: object
      required: [service_name, endpoint_count, metric_count, avg_qps, avg_error_rate, avg_response_time, last_seen, status]
      properties:
        service_name:
          type: string
        endpoint_count:
          type: integer
        metric_count:
          type: integer
        avg_qps:
          type: number
          format: float
        avg_error_rate:
          type: number
          format: float
        avg_response_time:
          type: number
          format: float
        last_seen:
          type: string
          format: date-time
        status:
          type: string
          enum: [active, inactive, unknown]

    ServiceEndpointsResponse:
      type: object
      required: [success, data, timestamp]
      properties:
        success:
          type: boolean
          example: true
        data:
          $ref: "#/components/schemas/ServiceEndpointsData"
        timestamp:
          type: string
          format: date-time

    ServiceEndpointsData:
      type: object
      required: [service_name, endpoints, summary]
      properties:
        service_name:
          type: string
        endpoints:
          type: array
          items:
            $ref: "#/components/schemas/EndpointMetrics"
        summary:
          $ref: "#/components/schemas/EndpointsSummary"

    EndpointMetrics:
      type: object
      required: [endpoint, method, qps, error_rate, avg_response_time, p95_response_time, total_requests, last_seen]
      properties:
        endpoint:
          type: string
        method:
          type: string
          enum: [GET, POST, PUT, DELETE, PATCH]
        qps:
          type: number
          format: float
        error_rate:
          type: number
          format: float
        avg_response_time:
          type: number
          format: float
        p95_response_time:
          type: number
          format: float
        total_requests:
          type: integer
        last_seen:
          type: string
          format: date-time

    EndpointsSummary:
      type: object
      required: [total_endpoints, total_requests, avg_qps, avg_error_rate]
      properties:
        total_endpoints:
          type: integer
        total_requests:
          type: integer
        avg_qps:
          type: number
          format: float
        avg_error_rate:
          type: number
          format: float

    AlertsResponse:
      type: object
      required: [success, data, timestamp]
      properties:
        success:
          type: boolean
          example: true
        data:
          $ref: "#/components/schemas/AlertsData"
        timestamp:
          type: string
          format: date-time

    AlertsData:
      type: object
      required: [alerts, pagination]
      properties:
        alerts:
          type: array
          items:
            $ref: "#/components/schemas/Alert"
        pagination:
          $ref: "#/components/schemas/Pagination"

    Alert:
      type: object
      required: [id, rule_name, severity, status, message, metric_value, threshold, triggered_at]
      properties:
        id:
          type: string
          example: "alert_123456"
        rule_name:
          type: string
          example: "é«˜éŒ¯èª¤ç‡å‘Šè­¦"
        severity:
          type: string
          enum: [low, medium, high, critical]
        status:
          type: string
          enum: [triggered, resolved, acknowledged]
        message:
          type: string
          example: "æœå‹™ model-api-v1 éŒ¯èª¤ç‡ = 5.2% > 5%"
        service_name:
          type: string
          nullable: true
        endpoint:
          type: string
          nullable: true
        metric_value:
          type: number
          format: float
        threshold:
          type: number
          format: float
        triggered_at:
          type: string
          format: date-time
        acknowledged_at:
          type: string
          format: date-time
          nullable: true
        resolved_at:
          type: string
          format: date-time
          nullable: true

    ActiveAlertsResponse:
      type: object
      required: [success, data, timestamp]
      properties:
        success:
          type: boolean
          example: true
        data:
          $ref: "#/components/schemas/ActiveAlertsData"
        timestamp:
          type: string
          format: date-time

    ActiveAlertsData:
      type: object
      required: [active_alerts, total_active, by_severity]
      properties:
        active_alerts:
          type: array
          items:
            $ref: "#/components/schemas/ActiveAlert"
        total_active:
          type: integer
        by_severity:
          $ref: "#/components/schemas/AlertSeverityCount"

    ActiveAlert:
      type: object
      required: [id, rule_name, severity, service_name, message, triggered_at, duration_minutes]
      properties:
        id:
          type: string
        rule_name:
          type: string
        severity:
          type: string
          enum: [low, medium, high, critical]
        service_name:
          type: string
          nullable: true
        message:
          type: string
        triggered_at:
          type: string
          format: date-time
        duration_minutes:
          type: integer

    AlertSeverityCount:
      type: object
      required: [critical, high, medium, low]
      properties:
        critical:
          type: integer
        high:
          type: integer
        medium:
          type: integer
        low:
          type: integer

    ServicesOverviewResponse:
      type: object
      required: [success, data, timestamp]
      properties:
        success:
          type: boolean
          example: true
        data:
          $ref: "#/components/schemas/ServicesOverviewData"
        timestamp:
          type: string
          format: date-time

    ServicesOverviewData:
      type: object
      required: [services, total_count, health_summary]
      properties:
        services:
          type: array
          items:
            $ref: "#/components/schemas/ServiceOverview"
        total_count:
          type: integer
        health_summary:
          $ref: "#/components/schemas/HealthSummary"

    ServiceOverview:
      type: object
      required: [service_name, status, last_seen, endpoint_count, avg_qps, avg_error_rate, avg_response_time, health_score]
      properties:
        service_name:
          type: string
        status:
          type: string
          enum: [healthy, degraded, unhealthy, unknown]
        last_seen:
          type: string
          format: date-time
        endpoint_count:
          type: integer
        avg_qps:
          type: number
          format: float
        avg_error_rate:
          type: number
          format: float
        avg_response_time:
          type: number
          format: float
        health_score:
          type: integer
          minimum: 0
          maximum: 100

    HealthSummary:
      type: object
      required: [healthy, degraded, unhealthy, unknown]
      properties:
        healthy:
          type: integer
        degraded:
          type: integer
        unhealthy:
          type: integer
        unknown:
          type: integer

    DashboardOverviewResponse:
      type: object
      required: [success, data, timestamp]
      properties:
        success:
          type: boolean
          example: true
        data:
          $ref: "#/components/schemas/DashboardOverviewData"
        timestamp:
          type: string
          format: date-time

    DashboardOverviewData:
      type: object
      required: [system_overview, service_health, alerts_summary, top_services]
      properties:
        system_overview:
          $ref: "#/components/schemas/SystemOverview"
        service_health:
          $ref: "#/components/schemas/ServiceHealthOverview"
        alerts_summary:
          $ref: "#/components/schemas/AlertsSummaryOverview"
        top_services:
          type: array
          items:
            $ref: "#/components/schemas/TopService"

    SystemOverview:
      type: object
      required: [total_services, total_endpoints, total_requests, total_errors, avg_qps, avg_error_rate, avg_response_time]
      properties:
        total_services:
          type: integer
        total_endpoints:
          type: integer
        total_requests:
          type: integer
        total_errors:
          type: integer
        avg_qps:
          type: number
          format: float
        avg_error_rate:
          type: number
          format: float
        avg_response_time:
          type: number
          format: float

    ServiceHealthOverview:
      type: object
      required: [healthy, degraded, unhealthy, unknown, total, health_percentage]
      properties:
        healthy:
          type: integer
        degraded:
          type: integer
        unhealthy:
          type: integer
        unknown:
          type: integer
        total:
          type: integer
        health_percentage:
          type: integer
          minimum: 0
          maximum: 100

    AlertsSummaryOverview:
      type: object
      required: [total_active, critical, high, medium, low]
      properties:
        total_active:
          type: integer
        critical:
          type: integer
        high:
          type: integer
        medium:
          type: integer
        low:
          type: integer

    TopService:
      type: object
      required: [service_name, qps, error_rate, avg_response_time]
      properties:
        service_name:
          type: string
        qps:
          type: number
          format: float
        error_rate:
          type: number
          format: float
        avg_response_time:
          type: number
          format: float

    TimeSeriesResponse:
      type: object
      required: [success, data, timestamp]
      properties:
        success:
          type: boolean
          example: true
        data:
          $ref: "#/components/schemas/TimeSeriesData"
        timestamp:
          type: string
          format: date-time

    TimeSeriesData:
      type: object
      required: [metric, time_range, timeseries, statistics]
      properties:
        metric:
          type: string
          enum: [qps, error_rate, avg_response_time, p95_response_time, p99_response_time]
        service_name:
          type: string
          nullable: true
        time_range:
          $ref: "#/components/schemas/TimeSeriesRange"
        timeseries:
          type: array
          items:
            $ref: "#/components/schemas/TimeSeriesPoint"
        statistics:
          $ref: "#/components/schemas/TimeSeriesStatistics"

    TimeSeriesRange:
      type: object
      required: [start_time, end_time, hours, interval_minutes]
      properties:
        start_time:
          type: string
          format: date-time
        end_time:
          type: string
          format: date-time
        hours:
          type: integer
        interval_minutes:
          type: integer

    TimeSeriesPoint:
      type: object
      required: [timestamp, value]
      properties:
        timestamp:
          type: string
          format: date-time
        value:
          type: number
          format: float

    TimeSeriesStatistics:
      type: object
      required: [min, max, avg, data_points]
      properties:
        min:
          type: number
          format: float
        max:
          type: number
          format: float
        avg:
          type: number
          format: float
        data_points:
          type: integer

    RealtimeDashboardResponse:
      type: object
      required: [success, data, timestamp]
      properties:
        success:
          type: boolean
          example: true
        data:
          $ref: "#/components/schemas/RealtimeDashboardData"
        timestamp:
          type: string
          format: date-time

    RealtimeDashboardData:
      type: object
      required: [real_time_metrics, services_status, alerts_summary, last_updated]
      properties:
        real_time_metrics:
          $ref: "#/components/schemas/RealtimeMetricsOverview"
        services_status:
          type: array
          items:
            $ref: "#/components/schemas/ServiceStatus"
        alerts_summary:
          $ref: "#/components/schemas/AlertsSummaryOverview"
        last_updated:
          type: string
          format: date-time

    RealtimeMetricsOverview:
      type: object
      required: [total_qps, overall_error_rate, avg_response_time, total_services]
      properties:
        total_qps:
          type: number
          format: float
        overall_error_rate:
          type: number
          format: float
        avg_response_time:
          type: number
          format: float
        total_services:
          type: integer

    ServiceStatus:
      type: object
      required: [service_name, status, qps, error_rate]
      properties:
        service_name:
          type: string
        status:
          type: string
          enum: [healthy, degraded, unhealthy, unknown]
        qps:
          type: number
          format: float
        error_rate:
          type: number
          format: float

  responses:
    BadRequestError:
      description: è«‹æ±‚åƒæ•¸ç„¡æ•ˆ
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          example:
            success: false
            error:
              code: "INVALID_PARAMETERS"
              message: "è«‹æ±‚åƒæ•¸ç„¡æ•ˆ"
              developer_message: "è«‹æª¢æŸ¥åƒæ•¸æ ¼å¼å’Œå¿…éœ€æ¬„ä½"
            timestamp: "2025-07-01T10:30:00Z"

    UnauthorizedError:
      description: èªè­‰å¤±æ•—
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          example:
            success: false
            error:
              code: "INVALID_API_KEY"
              message: "ç„¡æ•ˆçš„ API Key"
              developer_message: "è«‹æª¢æŸ¥æ‚¨çš„ API Key æ˜¯å¦æ­£ç¢º"
            timestamp: "2025-07-01T10:30:00Z"

    ForbiddenError:
      description: æ¬Šé™ä¸è¶³
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          example:
            success: false
            error:
              code: "INSUFFICIENT_PERMISSIONS"
              message: "æ¬Šé™ä¸è¶³"
              developer_message: "ç•¶å‰ API Key æ²’æœ‰è¨ªå•æ­¤è³‡æºçš„æ¬Šé™"
            timestamp: "2025-07-01T10:30:00Z"

    NotFoundError:
      description: è³‡æºä¸å­˜åœ¨
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          example:
            success: false
            error:
              code: "RESOURCE_NOT_FOUND"
              message: "è³‡æºä¸å­˜åœ¨"
              developer_message: "è«‹æª¢æŸ¥è«‹æ±‚çš„è³‡æºè·¯å¾‘æ˜¯å¦æ­£ç¢º"
            timestamp: "2025-07-01T10:30:00Z"

    RateLimitError:
      description: è«‹æ±‚é »ç‡è¶…éé™åˆ¶
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          example:
            success: false
            error:
              code: "RATE_LIMIT_EXCEEDED"
              message: "è«‹æ±‚é »ç‡è¶…éé™åˆ¶"
              developer_message: "æ¯åˆ†é˜æœ€å¤š 300 æ¬¡è«‹æ±‚"
            timestamp: "2025-07-01T10:30:00Z"
      headers:
        X-RateLimit-Limit:
          description: é€Ÿç‡é™åˆ¶
          schema:
            type: integer
            example: 300
        X-RateLimit-Remaining:
          description: å‰©é¤˜è«‹æ±‚æ•¸
          schema:
            type: integer
            example: 0
        X-RateLimit-Reset:
          description: é‡ç½®æ™‚é–“ (ç§’)
          schema:
            type: integer
            example: 60
        Retry-After:
          description: é‡è©¦é–“éš” (ç§’)
          schema:
            type: integer
            example: 60

    InternalServerError:
      description: å…§éƒ¨ä¼ºæœå™¨éŒ¯èª¤
      content:
        application/json:
          schema:
            $ref: "#/components/schemas/ErrorResponse"
          example:
            success: false
            error:
              code: "INTERNAL_SERVER_ERROR"
              message: "å…§éƒ¨ä¼ºæœå™¨éŒ¯èª¤"
              developer_message: "è«‹è¯ç¹«ç³»çµ±ç®¡ç†å“¡"
            timestamp: "2025-07-01T10:30:00Z"

tags:
  - name: ç³»çµ±
    description: ç³»çµ±åŸºç¤åŠŸèƒ½å’Œå¥åº·æª¢æŸ¥
  - name: æŒ‡æ¨™æŸ¥è©¢
    description: ç›£æ§æŒ‡æ¨™æ•¸æ“šæŸ¥è©¢
  - name: å‘Šè­¦ç®¡ç†
    description: å‘Šè­¦è¦å‰‡å’Œé€šçŸ¥ç®¡ç†
  - name: æœå‹™ç›£æ§
    description: æœå‹™ç‹€æ…‹å’Œå¥åº·ç›£æ§
  - name: å„€è¡¨æ¿
    description: å„€è¡¨æ¿æ•¸æ“šå’Œå¯è¦–åŒ–æ”¯æŒ 